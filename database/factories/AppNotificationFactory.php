<?php

namespace Database\Factories;

use App\Models\User;
use Illuminate\Database\Eloquent\Factories\Factory;

class AppNotificationFactory extends Factory
{
    public function definition(): array
    {
        $types = ['task', 'case', 'badge', 'system'];

        $titles = [
            'task' => [
                'Новая задача в симуляторе',
                'Задача требует внимания',
                'Задача почти завершена',
            ],
            'case' => [
                'Новый кейс от партнёра',
                'Ваша заявка рассмотрена',
                'Команда принята на кейс',
            ],
            'badge' => [
                'Вы получили новый бейдж!',
                'Поздравляем с достижением',
                'Открыт новый бейдж',
            ],
            'system' => [
                'Обновление системы',
                'Важные изменения',
                'Новые возможности',
            ],
        ];

        $messages = [
            'task' => [
                'Проверьте новую задачу в симуляторе. Вам доступно новое задание для прохождения.',
                'В симуляторе появилась новая задача. Не упустите возможность заработать дополнительные баллы.',
                'У вас есть новая задача в симуляторе. Приступайте к выполнению для получения опыта.',
            ],
            'case' => [
                'Проверьте детали нового кейса от партнера. Возможно, это именно то, что вы искали.',
                'Опубликован новый кейс, который может вас заинтересовать. Изучите требования и подайте заявку.',
                'Новый кейс доступен для подачи заявок. Успейте собрать команду и принять участие.',
            ],
            'badge' => [
                'Поздравляем! Вы получили новый бейдж. Проверьте свой профиль для просмотра достижения.',
                'Отличная работа! Вам присвоен новый бейдж за ваши успехи. Продолжайте в том же духе!',
                'Новый бейдж добавлен в вашу коллекцию. Откройте профиль, чтобы увидеть детали.',
            ],
            'system' => [
                'Система была обновлена. Теперь доступны новые функции и улучшения.',
                'В системе произошли важные изменения. Рекомендуем ознакомиться с обновлениями.',
                'Доступны новые возможности в системе. Изучите изменения для более эффективной работы.',
            ],
        ];
        
        $message = fake()->randomElement($messages[$type]);

        $type = fake()->randomElement($types);
        $title = fake()->randomElement($titles[$type]);
        $link = match ($type) {
            'task' => '/learning/simulator',
            'case' => '/cases',
            'badge' => '/profile',
            'system' => '/',
            default => '/',
        };

        return [
            'user_id' => User::factory(),
            'title' => $title,
            'message' => $message,
            'type' => $type,
            'link' => $link,
            'icon' => match ($type) {
                'task' => 'fa-tasks',
                'case' => 'fa-briefcase',
                'badge' => 'fa-award',
                'system' => 'fa-bell',
                default => 'fa-info-circle',
            },
            'action_text' => fake()->randomElement(['Перейти', 'Открыть', 'Просмотреть', 'Узнать больше']),
            'is_read' => fake()->boolean(40),
            'created_at' => fake()->dateTimeBetween('-1 month', 'now'),
        ];
    }
}
